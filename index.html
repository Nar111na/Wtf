<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { background: #0d0a1a; color: white; font-family: sans-serif; }
  
  /* Фон, который не грузит процессор */
  .rave-bg { position: fixed; inset: 0; z-index: -1; background: #0d0a1a; overflow: hidden; }
  .blob { 
    position: absolute; border-radius: 50%; width: 250px; height: 250px; 
    background: radial-gradient(circle, #6a11cb 0%, transparent 70%);
    animation: move 10s infinite alternate linear; opacity: 0.5;
  }
  .b1 { top: 10%; left: 10%; background: radial-gradient(circle, #6a11cb 0%, transparent 70%); }
  .b2 { bottom: 10%; right: 10%; background: radial-gradient(circle, #2575fc 0%, transparent 70%); animation-delay: -5s; }
  
  @keyframes move { 0% { transform: translate(0,0); } 100% { transform: translate(50px, 50px); } }

  /* Интерфейс */
  header { padding: 20px; text-align: center; font-size: 24px; font-weight: 900; letter-spacing: 2px; }
  .search { background: rgba(255,255,255,0.1); margin: 0 15px 15px; padding: 12px; border-radius: 12px; font-size: 14px; color: #ccc; }
  .list { padding: 0 15px; }
  .card { background: rgba(255,255,255,0.05); border-radius: 15px; display: flex; height: 90px; margin-bottom: 10px; overflow: hidden; border: 1px solid rgba(255,255,255,0.1); }
  .thumb { width: 130px; background: #000; }
  .thumb img { width: 100%; height: 100%; object-fit: cover; }
  .add { position: fixed; bottom: 30px; right: 25px; background: white; color: black; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 30px; font-weight: bold; }
</style>
<body>
  <div class="rave-bg"><div class="blob b1"></div><div class="blob b2"></div></div>
  <header>rave</header>
  <div class="search">Поиск</div>
  <div id="list" class="list">Загрузка данных...</div>
  <div class="add" onclick="create()">+</div>

  <script>
    const S_URL = 'https://otkessnonmdttowgkfrg.supabase.co';
    const S_KEY = 'Sb_publishable_J3AE0I_VFL0dvf3ffO7vbg_bwHJSWux';
    const sb = supabase.createClient(S_URL, S_KEY);

    async function load() {
      const { data, error } = await sb.from('rooms').select('*').gt('participants_count', 0).order('created_at', {ascending: false});
      if (error) { document.getElementById('list').innerText = "Ошибка базы"; return; }
      
      document.getElementById('list').innerHTML = data.length ? data.map(r => `
        <div class="card">
          <div class="thumb"><img src="https://picsum.photos/seed/${r.id}/200/120"></div>
          <div style="padding:10px"><b>${r.title}</b><p style="font-size:12px;opacity:0.5;margin-top:5px">${r.participants_count} участников</p></div>
        </div>`).join('') : "Комнат пока нет";
    }

    async function create() {
      const n = prompt("Название:");
      if(n) { await sb.from('rooms').insert([{title: n, participants_count: 1}]); load(); }
    }

    load();
    // Обновление без лишних тормозов
    setInterval(load, 5000); 
  </script>
</body>
